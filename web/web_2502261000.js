window.wh=function(){function o(){var n={};return{setItem:function(e,t){n[e]=String(t)},getItem:function(e){return n.hasOwnProperty(e)?n[e]:null},removeItem:function(e){delete n[e]},clear:function(){n={}}}}var i,t,a=function(e){try{var t,n,r="undefined"==typeof window?null:window[e];return null==r?o():(t="__storejs__test__",r.setItem(t,t),n=r.getItem(t)===t,r.removeItem(t),n?r:o())}catch(e){if(e instanceof DOMException)return o();throw e}}("localStorage");function c(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");e=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===e?"":decodeURIComponent(e[1].replace(/\+/g," "))}function n(e,t,n){var r,o="";n&&((r=new Date).setTime(r.getTime()+24*n*60*60*1e3),o="; expires="+r.toUTCString()),document.cookie=e+"="+t+o+"; path=/"}function e(e){for(var t=e+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var o=n[r];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(t))return o.substring(t.length,o.length)}return null}function s(e,t,n){var r=new XMLHttpRequest;if(r.withCredentials=!0,r.onloadend=function(){if(n){var t;try{t=JSON.parse(r.responseText)}catch(e){console.error("Error parsing API response",e),t=r.responseText}n({status:r.status,body:t})}},r.open("POST",i.API+e,!0),r.setRequestHeader("Accept","application/json"),t.headers)for(var o in t.headers)r.setRequestHeader(o,t.headers[o]);t.body&&(r.setRequestHeader("Content-Type","application/json; charset=UTF-8"),r.send(JSON.stringify(t.body)))}function r(e){e!=t&&(t=e,a.setItem("whUserId",t))}function u(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return(t=t||a.getItem("whUserId"))||r(e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()),t}function l(){return null!=e("whil")}function d(){return{clicked:a.getItem("whAttrClicked"),referrer:a.getItem("whAttrReferrer"),"landing-page":a.getItem("whAttrLanding"),ref:a.getItem("whAttrRef"),"utm-source":a.getItem("whAttrSource"),"utm-medium":a.getItem("whAttrMedium"),"utm-term":a.getItem("whAttrTerm"),"utm-content":a.getItem("whAttrContent"),"utm-campaign":a.getItem("whAttrCampaign"),gclid:a.getItem("whAttrGclid"),"web-version":e("X_wersion")}}var m,h=function(){var e,t=new URL(document.location);for(e of Array.from(t.searchParams.keys()))e.startsWith("utm_")&&t.searchParams.delete(e);history.replaceState(history.state,"",t)};function f(){var t,n=c("ref"),e=c("gclid"),e=!(!n&&!e);function r(){function e(e,t){t?a.setItem(e,t):a.removeItem(e)}e("whAttrClicked",(new Date).toISOString()),e("whAttrReferrer",t),e("whAttrLanding",document.location.href),e("whAttrRef",n),e("whAttrSource",c("utm_source")),e("whAttrMedium",c("utm_medium")),e("whAttrTerm",c("utm_term")),e("whAttrContent",c("utm_content")),e("whAttrCampaign",c("utm_campaign")),e("whAttrGclid",c("gclid"))}!e&&a.getItem("whAttrReferrer")||(t=document.referrer,e&&!l()?r():t?t.match(/(http|https):\/\/[\w\.]*whimsical.com.*/i)||t.match(/(http|https):\/\/[\w\.]*whimsical.co.*/i)||t.match(/https:\/\/accounts\.google\.com\.*/i)||r():a.getItem("whAttrLanding")||r(),!e&&a.getItem("whVisited"))||s("/api/account.visit",{body:{"user-id":u(),attr:d()}},function(e){200==e.status&&a.setItem("whVisited",!0)}),h()}function g(){var e;l()?(e=a.getItem("whWID"))&&s("/api/account.track-view-page",{body:{"workspace-id":e,url:window.location.href}}):((e=function(){try{var e=a.getItem("whPV");if(e)return JSON.parse(e)||[]}catch(e){console.error("whPV is invalid",e),a.removeItem("whPV")}return[]}()).push({visited:(new Date).toISOString(),page:document.location.pathname,referrer:document.referrer}),a.setItem("whPV",JSON.stringify(e)))}function w(e,t){e=document.querySelector(e+" .error");e.innerHTML=t,e.style.display=""}function p(e){e?window.location=e:window.location.pathname="/a"}function y(){return m=m||new Vimeo.Player("player",{id:"238290610",autoplay:!0,color:"00CCFF",title:!1})}function I(e){e=document.querySelectorAll(e);return[].slice.call(e)}return{init:function(e){i=e,(e=c("invite"))&&n("whir",e,365),f(),g()},subscribe:function(e,t){(t=document.querySelector(t)).checkValidity()&&(e.preventDefault(),e=t.elements.email.value,s("/api/account.subscribe",{body:{"user-id":u(),email:e,list:t.elements.list.value,attr:d()},headers:{x:function(e){var t,n=0;if(0!==e.length)for(t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return n}(e.toLowerCase())}},function(e){200==e.status&&r(e.body["user-id"])}),a.setItem("whReg",!0),t.innerHTML="<div class='success'>Thanks for subscribing! We'll keep you posted.</div>")},startGoogleLogin:function(n){s("/api/account.google.create-auth-url",{body:{"client-id":i.CID,"user-id":u(),refcode:c("invite")}},function(e){var t;200==e.status?window.location=e.body:(t=n,400!=(e=e).status&&401!=e.status&&418!=e.status||!e.body.message?w(t,"Sorry, there's a technical issue. We're on it."):(w(t,e.body.message),e.body.field&&((t=document.querySelector(t+" ."+e.body.field)).select(),t.focus())))})},loadApp:function(e){l()&&!c("r")&&p(e)},playVideo:function(e){var t;0==e.button&&((t=y()).setCurrentTime(.1).then(function(){t.play()}),document.getElementById("video").style.display="",e.preventDefault())},hideVideo:function(){y().pause(),document.getElementById("video").style.display="none"},select:function(e,t){I("."+t).forEach(function(e){e.classList.remove(t)}),I(e).forEach(function(e){e.classList.add(t)})},resetImage:function(e){var t=(e=e.target).src;e.src="#",e.src=t},trackPageView:g}}();